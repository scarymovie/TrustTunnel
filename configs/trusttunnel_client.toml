# =============================================================================
# TrustTunnel Client Configuration (trusttunnel_client.toml)
# =============================================================================
# Настройки клиента для подключения к VPN серверу
# =============================================================================

# -----------------------------------------------------------------------------
# Общие настройки
# -----------------------------------------------------------------------------

# Уровень логирования: "error", "warn", "info", "debug", "trace"
loglevel = "info"

# Режим маршрутизации:
# - "general"    : весь трафик через VPN, кроме exclusions
# - "selective"  : только exclusions через VPN, остальное напрямую
vpn_mode = "general"

# Kill Switch: блокировать трафик при потере VPN соединения
killswitch_enabled = true

# Локальные порты, разрешённые при активном Kill Switch
# Оставьте пустым [] для полной блокировки
killswitch_allow_ports = []

# Постквантовый обмен ключами в TLS (для дополнительной безопасности)
post_quantum_group_enabled = true

# -----------------------------------------------------------------------------
# Исключения (Split Tunneling)
# -----------------------------------------------------------------------------
# Форматы:
# - "example.com"      : домен + все поддомены
# - "*.example.com"    : только поддомены
# - "192.168.1.1"      : IPv4 адрес
# - "192.168.1.1:443"  : IPv4 с портом
# - "[::1]"            : IPv6 адрес
# - "[::1]:443"        : IPv6 с портом
# - "192.168.0.0/16"   : CIDR диапазон
#
# В режиме "general" - эти адреса НЕ идут через VPN
# В режиме "selective" - ТОЛЬКО эти адреса идут через VPN
# -----------------------------------------------------------------------------

exclusions = [
    # Локальная сеть (не идёт через VPN в режиме general)
    "10.0.0.0/8",
    "172.16.0.0/12",
    "192.168.0.0/16",
    
    # Пример: исключить определённые сайты
    # "netflix.com",
    # "*.netflix.com",
    
    # Пример: исключить конкретный IP
    # "192.168.1.100",
]

# -----------------------------------------------------------------------------
# DNS серверы
# -----------------------------------------------------------------------------
# Форматы:
# - "8.8.8.8:53"                           : Plain DNS
# - "tcp://8.8.8.8:53"                     : DNS over TCP
# - "tls://1.1.1.1"                        : DNS over TLS (DoT)
# - "https://dns.adguard.com/dns-query"    : DNS over HTTPS (DoH)
# - "quic://dns.adguard.com:8853"          : DNS over QUIC (DoQ)
# - "sdns://..."                           : DNS Stamp
# -----------------------------------------------------------------------------

dns_upstreams = [
    # Cloudflare DNS over TLS
    "tls://1.1.1.1",
    "tls://1.0.0.1",
    
    # Google DNS over TLS
    # "tls://8.8.8.8",
    # "tls://8.8.4.4",
    
    # AdGuard DNS (с блокировкой рекламы)
    # "https://dns.adguard.com/dns-query",
    
    # Quad9 DNS (с блокировкой вредоносных доменов)
    # "tls://9.9.9.9",
]

# -----------------------------------------------------------------------------
# Настройки эндпоинта (сервера)
# -----------------------------------------------------------------------------

[endpoint]
# Имя хоста для TLS SNI (должно совпадать с сертификатом сервера)
# ЗАМЕНИТЕ на ваш домен
hostname = "your-domain.com"

# Адреса сервера (pinger автоматически выберет лучший)
# Формат: "IP:порт" или "домен:порт"
# ЗАМЕНИТЕ на ваш IP
addresses = [
    "1.2.3.4:443",
    "your-domain.com:443",
]

# Разрешить маршрутизацию IPv6 через сервер
has_ipv6 = true

# Учётные данные (должны совпадать с credentials.toml на сервере)
username = "admin"
password = "ChangeMe_To_Secure_Password_123!"

# Префикс TLS client random (опционально, для обхода DPI)
# Формат: "префикс" или "префикс/маска" в hex
client_random = ""

# Пропустить проверку сертификата (НЕ рекомендуется для продакшена)
skip_verification = false

# Сертификат сервера в PEM формате (опционально)
# Оставьте пустым для использования системного хранилища
certificate = ""

# Протокол подключения: "http2" или "http3" (QUIC)
upstream_protocol = "http2"

# Меры против DPI (Deep Packet Inspection)
# Включает дополнительные техники маскировки трафика
anti_dpi = false

# -----------------------------------------------------------------------------
# Настройки TUN интерфейса (виртуальная сетевая карта)
# -----------------------------------------------------------------------------

[listener.tun]
# Сетевой интерфейс для VPN соединений (пусто = автоопределение)
bound_if = ""

# Маршруты для включения в VPN (CIDR)
included_routes = [
    "0.0.0.0/0",    # Весь IPv4 трафик
    "2000::/3",     # Весь IPv6 трафик
]

# Маршруты для исключения из VPN (CIDR)
excluded_routes = [
    "10.0.0.0/8",
    "172.16.0.0/12",
    "192.168.0.0/16",
    "127.0.0.0/8",
]

# MTU виртуального интерфейса (1280 рекомендуется для IPv6)
mtu_size = 1280

# Разрешить изменение системных DNS серверов
change_system_dns = true

# -----------------------------------------------------------------------------
# Настройки SOCKS5 прокси (альтернатива TUN интерфейсу)
# -----------------------------------------------------------------------------
# Раскомментируйте для использования вместо TUN интерфейса

# [listener.socks]
# address = "127.0.0.1:1080"
# username = "socksuser"      # опционально
# password = "sockspass"      # опционально

# =============================================================================
# Примеры конфигураций
# =============================================================================
#
# 1. Полный туннель (весь трафик через VPN):
#    vpn_mode = "general"
#    exclusions = []
#
# 2. Split tunnel (только определённые сайты через VPN):
#    vpn_mode = "selective"
#    exclusions = ["netflix.com", "*.netflix.com"]
#
# 3. С SOCKS5 прокси (для приложений с поддержкой прокси):
#    Закомментировать [listener.tun]
#    Раскомментировать [listener.socks]
#
# 4. Обход DPI (для стран с цензурой):
#    anti_dpi = true
#    client_random = "aabbcc"
#
# =============================================================================
