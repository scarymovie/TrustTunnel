# =============================================================================
# TrustTunnel Endpoint Configuration (vpn.toml)
# =============================================================================
# Основные настройки VPN эндпоинта
# =============================================================================

# -----------------------------------------------------------------------------
# Основные настройки
# -----------------------------------------------------------------------------

# Адрес и порт для прослушивания входящих соединений
# Формат: "IP:порт" или "0.0.0.0:порт" для всех интерфейсов
listen_address = "0.0.0.0:443"

# Разрешить маршрутизацию IPv6 трафика
ipv6_available = true

# Разрешить подключения к приватной сети самого эндпоинта
# Включите только если нужно обращаться к локальным ресурсам сервера
allow_private_network_connections = false

# -----------------------------------------------------------------------------
# Таймауты (в секундах)
# -----------------------------------------------------------------------------

# Время на завершение TLS рукопожатия
tls_handshake_timeout_secs = 10

# Таймаут неактивности клиентского соединения (10 минут)
client_listener_timeout_secs = 600

# Время ожидания установления исходящего соединения
connection_establishment_timeout_secs = 30

# Таймаут простоя для TCP соединений (1 неделя = 604800 сек)
tcp_connections_timeout_secs = 604800

# Таймаут простоя для UDP соединений (5 минут)
udp_connections_timeout_secs = 300

# -----------------------------------------------------------------------------
# Пути к файлам конфигурации
# -----------------------------------------------------------------------------

# Файл с учётными данными клиентов (обязательно)
credentials_file = "credentials.toml"

# Файл с правилами фильтрации (опционально, можно закомментировать)
rules_file = "rules.toml"

# -----------------------------------------------------------------------------
# Настройки протоколов прослушивания
# -----------------------------------------------------------------------------

[listen_protocols.http1]
# Размер буфера для исходящего трафика (байты)
upload_buffer_size = 32768

[listen_protocols.http2]
# Начальный размер окна управления потоком соединения (8 МБ)
initial_connection_window_size = 8388608
# Начальный размер окна управления потоком потока (128 КБ)
initial_stream_window_size = 131072
# Максимальное количество одновременных потоков
max_concurrent_streams = 1000
# Максимальный размер полезной нагрузки фрейма
max_frame_size = 16384
# Максимальный размер таблицы заголовков
header_table_size = 65536

[listen_protocols.quic]
# Максимальный размер получаемого UDP пакета
recv_udp_payload_size = 1350
# Максимальный размер отправляемого UDP пакета
send_udp_payload_size = 1350
# Максимум данных соединения (100 МБ)
initial_max_data = 104857600
# Локальный двунаправленный поток (1 МБ)
initial_max_stream_data_bidi_local = 1048576
# Удалённый двунаправленный поток (1 МБ)
initial_max_stream_data_bidi_remote = 1048576
# Однонаправленный поток (1 МБ)
initial_max_stream_data_uni = 1048576
# Максимум двунаправленных потоков
initial_max_streams_bidi = 4096
# Максимум однонаправленных потоков
initial_max_streams_uni = 4096
# Максимальное окно соединения (24 МБ)
max_connection_window = 25165824
# Максимальное окно потока (16 МБ)
max_stream_window = 16777216
# Отключить активную миграцию соединения
disable_active_migration = true
# Включить 0-RTT ранние данные (улучшает производительность)
enable_early_data = true
# Ёмкость очереди мультиплексора QUIC
message_queue_capacity = 4096

# -----------------------------------------------------------------------------
# Протокол пересылки (как клиент подключается к целевым ресурсам)
# -----------------------------------------------------------------------------

# Вариант 1: Прямая пересылка (по умолчанию)
[forward_protocol]
direct = {}

# Вариант 2: Через SOCKS5 прокси (раскомментировать при необходимости)
# [forward_protocol.socks5]
# address = "127.0.0.1:1080"
# extended_auth = false

# -----------------------------------------------------------------------------
# Обратный прокси (опционально, для проксирования локальных сервисов)
# -----------------------------------------------------------------------------

# [reverse_proxy]
# server_address = "127.0.0.1:8080"
# path_mask = "/api"
# h3_backward_compatibility = false

# -----------------------------------------------------------------------------
# ICMP настройки (опционально, требует root/admin прав)
# -----------------------------------------------------------------------------

# [icmp]
# interface_name = "eth0"
# request_timeout_secs = 3
# recv_message_queue_capacity = 256

# -----------------------------------------------------------------------------
# Метрики (опционально, для мониторинга)
# -----------------------------------------------------------------------------

# [metrics]
# address = "127.0.0.1:1987"
# request_timeout_secs = 3
