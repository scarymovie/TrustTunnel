# =============================================================================
# TrustTunnel Filtering Rules (rules.toml)
# =============================================================================
# Правила фильтрации входящих соединений
# =============================================================================
#
# Правила оцениваются ПО ПОРЯДКУ сверху вниз
# Применяется действие ПЕРВОГО совпавшего правила
# Если нет совпадений - соединение РАЗРЕШАЕТСЯ по умолчанию
#
# Форматы правил:
# - cidr: диапазон IP в CIDR нотации (опционально)
# - client_random_prefix: префикс TLS client random в hex (опционально)
# - action: "allow" (разрешить) или "deny" (заблокировать)
#
# Если указаны и cidr, и client_random_prefix - должны совпасть ОБА
# =============================================================================

# -----------------------------------------------------------------------------
# Пример 1: Заблокировать частные диапазоны IP
# -----------------------------------------------------------------------------
# Запретить подключения из локальной сети 192.168.x.x
[[rule]]
cidr = "192.168.0.0/16"
action = "deny"

# Запретить подключения из 10.x.x.x
[[rule]]
cidr = "10.0.0.0/8"
action = "deny"

# Запретить подключения из 172.16.x.x - 172.31.x.x
[[rule]]
cidr = "172.16.0.0/12"
action = "deny"

# -----------------------------------------------------------------------------
# Пример 2: Разрешить только определённые IP
# -----------------------------------------------------------------------------
# Разрешить только с конкретного IP
# [[rule]]
# cidr = "203.0.113.50/32"
# action = "allow"

# -----------------------------------------------------------------------------
# Пример 3: Фильтрация по TLS Client Random
# -----------------------------------------------------------------------------
# Разрешить только клиентов с определённым префиксом client random
# [[rule]]
# client_random_prefix = "aabbcc"
# action = "allow"

# Заблокировать по префиксу с маской (побитовое сравнение)
# Формат: "префикс/маска" в hex
# [[rule]]
# client_random_prefix = "bad0/ff00"
# action = "deny"

# -----------------------------------------------------------------------------
# Пример 4: Комбинированные правила
# -----------------------------------------------------------------------------
# Заблокировать определённый IP с определённым client random
# [[rule]]
# cidr = "198.51.100.10/32"
# client_random_prefix = "deadbeef"
# action = "deny"

# -----------------------------------------------------------------------------
# Пример 5: Запретить всё (размещать ПОСЛЕДНИМ правилом)
# -----------------------------------------------------------------------------
# Если раскомментировать - ВСЕ неподходящие под предыдущие
# правила будут заблокированы
# [[rule]]
# action = "deny"

# =============================================================================
# Справка по CIDR нотации
# =============================================================================
#
# /32 - один конкретный IP (например, 192.168.1.1/32)
# /24 - 256 адресов (например, 192.168.1.0/24 = 192.168.1.0-255)
# /16 - 65536 адресов (например, 192.168.0.0/16 = 192.168.0.0-65535)
# /8  - 16 миллионов адресов (например, 10.0.0.0/8)
# /0  - все адреса (0.0.0.0/0)
#
# =============================================================================
#
# Справка по client_random_prefix
# --------------------------------
#
# Простой префикс:
#   "aabbcc" - совпадает если client random начинается с 0xaabbcc
#
# Префикс с маской:
#   "a0b0/f0f0" - совпадает если (client_random & 0xf0f0) == (0xa0b0 & 0xf0f0)
#
# =============================================================================
