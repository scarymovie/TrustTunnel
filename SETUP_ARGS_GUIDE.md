# ๐ ะะฐัััะพะนะบะฐ TrustTunnel ะดะปั ะฒะฐัะตะณะพ ะดะพะผะตะฝะฐ

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต ัะบัะธะฟัะฐ setup.sh

### ะะตะถะธะผ 1: ะก ะฐัะณัะผะตะฝัะฐะผะธ ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ

```bash
# ะะพะปะฝัะน ะฒะฐัะธะฐะฝั ั ะดะพะผะตะฝะพะผ ะธ IP
sudo ./setup.sh -d scary.ru -i 0.0.0.1

# ะขะพะปัะบะพ ะดะพะผะตะฝ (IP ะทะฐะฟัะพัะธััั ะฒ ะฟัะพัะตััะต)
sudo ./setup.sh -d your-domain.com

# ะะพะบะฐะทะฐัั ัะฟัะฐะฒะบั
sudo ./setup.sh --help
```

**ะัะณัะผะตะฝัั:**
- `-d, --domain <domain>` โ ะะพะผะตะฝ ัะตัะฒะตัะฐ
- `-i, --ip <ip>` โ IP ะฐะดัะตั ัะตัะฒะตัะฐ
- `-h, --help` โ ะะพะบะฐะทะฐัั ัะฟัะฐะฒะบั

---

### ะะตะถะธะผ 2: ะะฝัะตัะฐะบัะธะฒะฝัะน

```bash
sudo ./setup.sh
```

ะกะบัะธะฟั ะทะฐะฟัะพัะธั:
1. ะะพะผะตะฝ ัะตัะฒะตัะฐ
2. IP ะฐะดัะตั ัะตัะฒะตัะฐ

---

## ะะตะฝั ัะบัะธะฟัะฐ

ะะพัะปะต ะฒะฒะพะดะฐ ะดะพะผะตะฝะฐ ะธ IP ะพัะบัะพะตััั ะผะตะฝั:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   TrustTunnel Setup Script               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

  1. ะฃััะฐะฝะพะฒะธัั ัะตัะฒะตั (Endpoint)
  2. ะะพะฟะธัะพะฒะฐัั ะบะพะฝัะธะณะธ ะฒ /opt/trusttunnel
  3. ะกะณะตะฝะตัะธัะพะฒะฐัั ัะฐะผะพะฟะพะดะฟะธัะฐะฝะฝัะน ัะตััะธัะธะบะฐั
  4. ะะฐัััะพะธัั ัะตัะฒะตั (ะผะฐััะตั)
  5. ะะฐัััะพะธัั systemd ัะตัะฒะธั
  ----------------------------------------
  6. ะฃััะฐะฝะพะฒะธัั ะบะปะธะตะฝัะฐ
  7. ะะพะฟะธัะพะฒะฐัั ะบะปะธะตะฝััะบะธะน ะบะพะฝัะธะณ
  8. ะะฐัััะพะธัั ะบะปะธะตะฝัะฐ
  ----------------------------------------
  9. ะญะบัะฟะพััะธัะพะฒะฐัั ะบะพะฝัะธะณััะฐัะธั ะบะปะธะตะฝัะฐ
  10. ะัะพะฒะตัะธัั ััะฐััั ัะตัะฒะธัะพะฒ
  ----------------------------------------
  0. ะัะนัะธ
```

---

## ะะฒัะพะผะฐัะธัะตัะบะฐั ะฝะฐัััะพะนะบะฐ (ะฟะพะปะฝัะน ัะธะบะป)

```bash
# 1. ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ ัะตัะฒะตัะฐ
sudo ./setup.sh -d scary.ru -i 0.0.0.1 << EOF
1
2
3
5
0
EOF

# 2. ะฃััะฐะฝะพะฒะบะฐ ะธ ะฝะฐัััะพะนะบะฐ ะบะปะธะตะฝัะฐ
sudo ./setup.sh -d scary.ru -i 0.0.0.1 << EOF
6
7
0
EOF
```

---

## ะงัะพ ะดะตะปะฐะตั ัะบัะธะฟั

### ะะปั ัะตัะฒะตัะฐ:
1. **ะฃััะฐะฝะพะฒะบะฐ** โ ัะบะฐัะธะฒะฐะตั ะธ ัััะฐะฝะฐะฒะปะธะฒะฐะตั TrustTunnel Endpoint
2. **ะะพะฟะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณะพะฒ** โ ะบะพะฟะธััะตั ัะฐะนะปั ะธะท `configs/` ั ะฟะพะดััะฐะฝะพะฒะบะพะน ะดะพะผะตะฝะฐ ะธ IP
3. **ะกะตััะธัะธะบะฐั** โ ะณะตะฝะตัะธััะตั ัะฐะผะพะฟะพะดะฟะธัะฐะฝะฝัะน ัะตััะธัะธะบะฐั ะดะปั ัะบะฐะทะฐะฝะฝะพะณะพ ะดะพะผะตะฝะฐ
4. **Systemd** โ ะฝะฐัััะฐะธะฒะฐะตั ะฐะฒัะพะทะฐะฟััะบ ัะตัะฒะธัะฐ

### ะะปั ะบะปะธะตะฝัะฐ:
1. **ะฃััะฐะฝะพะฒะบะฐ** โ ัะบะฐัะธะฒะฐะตั ะธ ัััะฐะฝะฐะฒะปะธะฒะฐะตั TrustTunnel Client
2. **ะะพะฟะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณะฐ** โ ะบะพะฟะธััะตั `trusttunnel_client.toml` ั ะฟะพะดััะฐะฝะพะฒะบะพะน ะดะพะผะตะฝะฐ ะธ IP

---

## ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะัะธะผะตั 1: ะะตัะฒัะน ะทะฐะฟััะบ ัะตัะฒะตัะฐ

```bash
# ะฃััะฐะฝะพะฒะบะฐ ั ะฒะฐัะธะผะธ ะฟะฐัะฐะผะตััะฐะผะธ
sudo ./setup.sh -d scary.ru -i 0.0.0.1

# ะ ะผะตะฝั ะฒัะฑะตัะธัะต:
# 1 โ ะฃััะฐะฝะพะฒะบะฐ ัะตัะฒะตัะฐ
# 2 โ ะะพะฟะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณะพะฒ (ะดะพะผะตะฝ ะธ IP ะฟะพะดััะฐะฒัััั ะฐะฒัะพะผะฐัะธัะตัะบะธ)
# 3 โ ะะตะฝะตัะฐัะธั ัะตััะธัะธะบะฐัะฐ ะดะปั scary.ru
# 5 โ ะะฐัััะพะนะบะฐ systemd
# 0 โ ะััะพะด
```

### ะัะธะผะตั 2: ะะฐัััะพะนะบะฐ ะบะปะธะตะฝัะฐ

```bash
# ะะฐ ัะพะผ ะถะต ัะตัะฒะตัะต ะธะปะธ ะพัะดะตะปัะฝะพ
sudo ./setup.sh -d scary.ru -i 0.0.0.1

# ะ ะผะตะฝั ะฒัะฑะตัะธัะต:
# 6 โ ะฃััะฐะฝะพะฒะบะฐ ะบะปะธะตะฝัะฐ
# 7 โ ะะพะฟะธัะพะฒะฐะฝะธะต ะบะปะธะตะฝััะบะพะณะพ ะบะพะฝัะธะณะฐ
# 0 โ ะััะพะด

# ะััะตะดะฐะบัะธััะนัะต ะฟะฐัะพะปั
nano /opt/trusttunnel_client/trusttunnel_client.toml

# ะะฐะฟัััะธัะต ะบะปะธะตะฝัะฐ
sudo /opt/trusttunnel_client/trusttunnel_client -c /opt/trusttunnel_client/trusttunnel_client.toml
```

### ะัะธะผะตั 3: ะญะบัะฟะพัั ะบะพะฝัะธะณััะฐัะธะธ ะดะปั ะผะพะฑะธะปัะฝะพะณะพ ะบะปะธะตะฝัะฐ

```bash
sudo ./setup.sh -d scary.ru -i 0.0.0.1

# ะ ะผะตะฝั ะฒัะฑะตัะธัะต:
# 9 โ ะญะบัะฟะพัั ะบะพะฝัะธะณััะฐัะธะธ
# ะะฒะตะดะธัะต ะธะผั ะบะปะธะตะฝัะฐ (ะฝะฐะฟัะธะผะตั: mobile)
# ะะฐะถะผะธัะต Y ะดะปั ะธัะฟะพะปัะทะพะฒะฐะฝะธั IP ะฟะพ ัะผะพะปัะฐะฝะธั

# ะะพะปััะธัะต tt:// ัััะปะบั ะดะปั QR-ะบะพะดะฐ
```

---

## ะกัััะบัััะฐ ะบะพะฝัะธะณะพะฒ

### configs/hosts.toml (ัะฐะฑะปะพะฝ)
```toml
[[main_hosts]]
hostname = "your-domain.com"  # ะะฒัะพะผะฐัะธัะตัะบะธ ะทะฐะผะตะฝัะตััั
cert_chain_path = "certs/cert.pem"
private_key_path = "certs/key.pem"
```

### configs/trusttunnel_client.toml (ัะฐะฑะปะพะฝ)
```toml
[endpoint]
hostname = "your-domain.com"     # ะะฒัะพะผะฐัะธัะตัะบะธ ะทะฐะผะตะฝัะตััั
addresses = ["1.2.3.4:443"]      # ะะฒัะพะผะฐัะธัะตัะบะธ ะทะฐะผะตะฝัะตััั
username = "admin"
password = "ChangeMe_To_Secure_Password_123!"
```

---

## ะััะฝะพะต ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะบะพะฝัะธะณะพะฒ

ะัะปะธ ะฝัะถะฝะพ ะธะทะผะตะฝะธัั ะฝะฐัััะพะนะบะธ ะฟะพัะปะต ะบะพะฟะธัะพะฒะฐะฝะธั:

```bash
# ะกะตัะฒะตั
nano /opt/trusttunnel/hosts.toml
nano /opt/trusttunnel/credentials.toml

# ะะปะธะตะฝั
nano /opt/trusttunnel_client/trusttunnel_client.toml

# ะะตัะตะทะฐะฟััะบ ะฟะพัะปะต ะธะทะผะตะฝะตะฝะธะน
systemctl restart trusttunnel
```

---

## ะัะพะฒะตัะบะฐ ัะฐะฑะพัั

```bash
# ะกัะฐััั ัะตัะฒะตัะฐ
systemctl status trusttunnel

# ะะพะณะธ
journalctl -u trusttunnel -f

# ะัะพะฒะตัะบะฐ ะฟะพััะฐ
nc -zv scary.ru 443

# ะขะตัั ะฟะพะดะบะปััะตะฝะธั
curl -k https://scary.ru
```

---

## ะะตะทะพะฟะฐัะฝะพััั

1. **ะกะผะตะฝะธัะต ะฟะฐัะพะปะธ** ะฒ `configs/credentials.toml` ะฟะตัะตะด ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ
2. **ะะณัะฐะฝะธัััะต ะดะพัััะฟ** ะบ ัะฐะนะปะฐะผ:
   ```bash
   chmod 600 /opt/trusttunnel/credentials.toml
   ```

3. **ะัะฟะพะปัะทัะนัะต Let's Encrypt** ะดะปั ะฟัะพะดะฐะบัะตะฝะฐ:
   ```bash
   # ะ ะผะตะฝั ัะบัะธะฟัะฐ ะฒัะฑะตัะธัะต ะฟัะฝะบั 4 (ะผะฐััะตั ะฝะฐัััะพะนะบะธ)
   # ะัะฑะตัะธัะต "Issue a Let's Encrypt certificate"
   ```

---

## ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะกะบัะธะฟั ะฝะต ะฒะธะดะธั ะฐัะณัะผะตะฝัั
```bash
# ะัะพะฒะตัััะต ัะพัะผะฐั
sudo ./setup.sh -d domain.com -i 1.2.3.4
# ะะต ะธัะฟะพะปัะทัะนัะต = ะผะตะถะดั ะบะปััะพะผ ะธ ะทะฝะฐัะตะฝะธะตะผ
```

### ะะพะฝัะธะณะธ ะฝะต ะบะพะฟะธัััััั
```bash
# ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ะดะธัะตะบัะพัะธะธ configs
ls -la configs/

# ะัะพะฒะตัััะต ะฟัะฐะฒะฐ ะดะพัััะฟะฐ
chmod +x setup.sh
```

### ะกะตััะธัะธะบะฐั ะฝะต ะณะตะฝะตัะธััะตััั
```bash
# ะฃััะฐะฝะพะฒะธัะต OpenSSL
apt install openssl

# ะะพะฟัะพะฑัะนัะต ะฒัััะฝัั
cd /opt/trusttunnel
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
  -keyout certs/key.pem \
  -out certs/cert.pem \
  -subj "/CN=your-domain.com"
```
